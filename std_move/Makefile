PROJECT_SOURCE_DIR ?= $(abspath ./)
BUILD_DIR ?= $(PROJECT_SOURCE_DIR)/build
INSTALL_DIR ?= $(PROJECT_SOURCE_DIR)/build/install
CMAKE_BUILD_TYPE ?= Release
EXTERNAL_ZHTSDK ?= OFF


CMAKE_ARGS := \
	-DCMAKE_BUILD_TYPE=$(CMAKE_BUILD_TYPE) \
	-DCMAKE_INSTALL_PREFIX=$(INSTALL_DIR) \
	-DCMAKE_POSITION_INDEPENDENT_CODE=ON -DCMAKE_CXX_FLAGS=-fPIC -DCMAKE_C_FLAGS=-fPIC \
	-DEXTERNAL_ZHTSDK=$(EXTERNAL_ZHTSDK) \

clean:
	rm -rf $(BUILD_DIR)

build:
	mkdir -p $(BUILD_DIR) && cd $(BUILD_DIR) && \
	cmake $(PROJECT_SOURCE_DIR) $(CMAKE_ARGS) && \
	make -j$(NUM_JOB) \
	# && make install
	
.PHONY: build